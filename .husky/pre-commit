#!/bin/sh
# Get staged TypeScript/React files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(ts|tsx)$' || true)

if [ -n "$STAGED_FILES" ]; then
  # Lint only staged files
  npx eslint $STAGED_FILES
  
  # TypeScript check for the whole project (since tsc doesn't support file-level checking)
  npm run typecheck

  # Run prettier on staged files (no write-back) and check for formatting issues
  npx prettier --check $STAGED_FILES

  if [ $? -ne 0 ]; then
    echo "Linting, type checking, or formatting failed. Please fix the issues before committing."
    exit 1
  fi

else
  echo "No TypeScript/React files staged, skipping lint and typecheck"
fi
